## 一、浏览器进程模型

### 1. 浏览器有哪些主要进程？ 🔥

**一句话回答**
浏览器采用多进程架构，常见有浏览器主进程、渲染进程、网络进程、GPU 进程、插件进程。

**要点**

- 主进程：界面、用户交互。
- 渲染进程：执行 JS、渲染页面。
- 网络进程：处理网络请求。
- GPU 进程：3D/硬件加速。

**详细回答**

- 每个 Tab 页面一般是独立的渲染进程，保证隔离性。
- 渲染进程内部包含 **GUI 渲染线程、JS 引擎线程、事件触发线程、定时器线程**。

**扩展/对比**

- 面试官可能问：“为什么浏览器要多进程？” 👉 避免单页面崩溃导致整个浏览器挂掉，提高安全性和性能。

---

### 2. 浏览器中的线程有哪些？ 🔥

**一句话回答**
浏览器渲染进程中常见线程：GUI 渲染线程、JS 引擎线程、事件触发线程、定时器线程、异步 http 请求线程。

**要点**

- GUI 渲染线程：负责布局绘制。
- JS 引擎线程：执行 JS（单线程）。
- 两者互斥。
- 定时器 / 事件线程：执行异步任务。

**详细回答**

- JS 引擎与 GUI 渲染线程互斥，避免 DOM 渲染和修改冲突。
- 异步请求通过事件线程回调放入任务队列。

**扩展/对比**

- 面试官可能问：“为什么 JS 是单线程的？” 👉 为了保证 DOM 操作一致性。

---

## 二、页面渲染流程

### 3. 浏览器从输入 URL 到页面渲染的过程 🔥

**一句话回答**
从输入 URL 到页面渲染，主要经历：DNS 解析 → 建立连接 → 发送请求 → 解析响应 → 构建 DOM & CSSOM → Render Tree → Layout → Paint → Composite。

**要点**

- 网络层：DNS、TCP、TLS、HTTP。
- 渲染层：DOM、CSSOM、Render Tree。
- 渲染流水线：布局、绘制、合成。

**详细回答**

1. **DNS 解析** → 获取服务器 IP。
2. **TCP 三次握手** → 建立连接（HTTPS 还需 TLS 握手）。
3. **发送 HTTP 请求**，获取 HTML。
4. **解析 HTML → DOM 树**（文档结构，包含所有节点）。
5. **解析 CSS → CSSOM 树**（样式树）。
6. **合并 DOM + CSSOM → Render Tree**（去掉不可见节点，可见元素的渲染结构）。
7. **Layout（布局计算）** → 位置大小。
8. **Paint（绘制）** → 像素信息。
9. **Composite（合成）** → GPU 合成图层。

**扩展/对比**

- 面试官常问：“白屏时间长的原因可能是什么？” 👉 DNS、首字节延迟、JS 阻塞渲染。

---

### 4. DOM 树与 Render Tree 的区别

**一句话回答**
DOM 树表示文档结构，Render Tree 表示可见元素的渲染结构。

**要点**

- DOM：HTML 解析结果。
- CSSOM：样式树。
- Render Tree：DOM + CSSOM，去掉不可见节点。

**详细回答**

- DOM 包含所有节点。
- Render Tree 只包含可见节点，并计算出样式信息。

**扩展/对比**

- 面试官可能问：“为什么修改 DOM 会导致回流？” 👉 因为需要重新计算 Render Tree 和 Layout。

---

## 三、回流与重绘

### 5. 回流（Reflow）与重绘（Repaint）的区别 🔥

**一句话回答**
回流涉及布局重新计算，重绘只涉及外观变化。

**要点**

- 回流：改变大小、位置、结构。
- 重绘：改变颜色、背景、阴影。
- 回流开销 > 重绘。

**详细回答**

- 回流会触发 Layout → Paint → Composite。
- 重绘只触发 Paint → Composite。

**扩展/对比**

- 面试官可能问：“如何减少回流？” 👉 使用 transform/opacity 代替位置变化。

---

### 6. 如何减少回流与重绘 🔥

**一句话回答**
合并 DOM 操作、`classList` 一次性修改、动画用 transform，透明变化可以使用opacity 代替。

**要点**

- 批量 DOM 修改。
- requestAnimationFrame。
- CSS3 动画优先。

**详细回答**

- 批量修改 DOM 时用 DocumentFragment 或 `classList` 一次性修改。
- 动画用 transform，不触发布局计算。

**扩展/对比**

- 面试官可能问：“为什么 transform 比 top/left 性能好？” 👉 transform 不触发布局，只走 GPU 合成层。

---

## 四、跨域与安全

### 7. 什么是同源策略 🔥

**一句话回答**
同源策略限制不同源之间访问 DOM、Cookie、Storage、indexedDB 等，保障安全，以及AJAX 请求。

**要点**

- 协议、域名、端口必须相同。
- 保护用户数据。

**详细回答**

- 非同源网站不能随意读取 Cookie / DOM。
- AJAX 请求跨域时需 CORS 头部。

**扩展/对比**

- 面试官可能问：“同源策略限制了哪些内容？” 👉 DOM 访问、Storage、AJAX 请求。

---

### 8. 跨域的解决方案 🔥

**一句话回答**
常见跨域解决方案：CORS、JSONP、代理转发、postMessage。

**要点**

- CORS：服务端设置 `Access-Control-Allow-Origin`。
- JSONP：利用 script 标签跨域。
- 代理：Nginx/Node 转发。
- postMessage：跨窗口通信。

**详细回答**

- CORS 是现代最常见方案。
- JSONP 仅支持 GET。
- 代理适合本地开发（devServer）。

**扩展/对比**

- 面试官可能问：“为什么 Cookie 默认不跨域？” 👉 防止 CSRF。
