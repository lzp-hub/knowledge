# 数字与数学方法发展史

## 📚 目录

- [ES1 时代（1997 年）](#es1-时代1997年)
- [ES3 时代（1999 年）](#es3-时代1999年)
- [ES5 时代（2009 年）](#es5-时代2009年)
- [ES2015/ES6 时代（2015 年）](#es2015es6-时代2015年)
- [ES2017 时代（2017 年）](#es2017-时代2017年)
- [ES2021 时代（2021 年）](#es2021-时代2021年)
- [实际应用场景](#实际应用场景)
- [性能对比与最佳实践](#性能对比与最佳实践)
- [面试常考算法](#面试常考算法)

---

## ES1 时代（1997 年）

### 📝 ES1 数字方法总览

| 功能分类 | 方法         | 语法                      | 参数        | 返回值 | 用途         |
| -------- | ------------ | ------------------------- | ----------- | ------ | ------------ |
| **转换** | Number()     | `Number(value)`           | 任意值      | 数字   | 类型转换     |
| **转换** | parseInt()   | `parseInt(string, radix)` | 字符串,进制 | 数字   | 字符串转整数 |
| **转换** | parseFloat() | `parseFloat(string)`      | 字符串      | 数字   | 字符串转浮点 |
| **检查** | isNaN()      | `isNaN(value)`            | 任意值      | 布尔值 | 检查 NaN     |
| **检查** | isFinite()   | `isFinite(value)`         | 任意值      | 布尔值 | 检查有限数   |

### 🔧 ES1 详细方法说明

**Number() - 类型转换**

```javascript
// 语法：Number(value)
// 参数：任意值
// 返回值：数字

console.log(Number("123")); // 123
console.log(Number("123.45")); // 123.45
console.log(Number("")); // 0
console.log(Number("abc")); // NaN
console.log(Number(true)); // 1
console.log(Number(false)); // 0

// 实际应用：表单数据处理
function processFormData(formData) {
  return {
    age: Number(formData.age),
    salary: Number(formData.salary),
    isActive: Boolean(formData.isActive),
  };
}
```

**parseInt() - 字符串转整数**

```javascript
// 语法：parseInt(string, radix)
// 参数：字符串, 进制（2-36）
// 返回值：整数

console.log(parseInt("123")); // 123
console.log(parseInt("123.45")); // 123
console.log(parseInt("1010", 2)); // 10 (二进制)
console.log(parseInt("FF", 16)); // 255 (十六进制)
console.log(parseInt("abc")); // NaN

// 实际应用：进制转换
function convertBase(number, fromBase, toBase) {
  const decimal = parseInt(number, fromBase);
  return decimal.toString(toBase);
}
```

**parseFloat() - 字符串转浮点**

```javascript
// 语法：parseFloat(string)
// 参数：字符串
// 返回值：浮点数

console.log(parseFloat("123.45")); // 123.45
console.log(parseFloat("123")); // 123
console.log(parseFloat("123.45.67")); // 123.45
console.log(parseFloat("abc")); // NaN

// 实际应用：价格计算
function calculatePrice(priceStr, taxRate) {
  const price = parseFloat(priceStr);
  return price * (1 + taxRate);
}
```

---

## ES3 时代（1999 年）

> **🎯 解决的问题**：ES3 扩展了 Math 对象，提供了丰富的数学计算方法，解决了基础数学运算的需求，让数值计算更加便捷。

### 📝 ES3 Math 方法总览

| 功能分类 | 方法          | 语法                   | 参数      | 返回值 | 用途     |
| -------- | ------------- | ---------------------- | --------- | ------ | -------- |
| **基础** | Math.abs()    | `Math.abs(x)`          | 数字      | 数字   | 绝对值   |
| **基础** | Math.max()    | `Math.max(...numbers)` | 数字列表  | 数字   | 最大值   |
| **基础** | Math.min()    | `Math.min(...numbers)` | 数字列表  | 数字   | 最小值   |
| **舍入** | Math.round()  | `Math.round(x)`        | 数字      | 数字   | 四舍五入 |
| **舍入** | Math.ceil()   | `Math.ceil(x)`         | 数字      | 数字   | 向上取整 |
| **舍入** | Math.floor()  | `Math.floor(x)`        | 数字      | 数字   | 向下取整 |
| **幂次** | Math.pow()    | `Math.pow(base, exp)`  | 底数,指数 | 数字   | 幂运算   |
| **根号** | Math.sqrt()   | `Math.sqrt(x)`         | 数字      | 数字   | 平方根   |
| **随机** | Math.random() | `Math.random()`        | 无        | 数字   | 随机数   |

### 🔧 ES3 详细方法说明

**Math.max() / Math.min() - 最值计算**

```javascript
// 语法：Math.max(...numbers) / Math.min(...numbers)
// 参数：数字列表
// 返回值：最大/最小值

console.log(Math.max(1, 2, 3, 4, 5)); // 5
console.log(Math.min(1, 2, 3, 4, 5)); // 1

// 实际应用：数组最值
function getArrayExtremes(arr) {
  return {
    max: Math.max(...arr),
    min: Math.min(...arr),
  };
}
```

**Math.random() - 随机数生成**

```javascript
// 语法：Math.random()
// 参数：无
// 返回值：0-1之间的随机数

console.log(Math.random()); // 0.123456789

// 实际应用：随机整数生成
function randomInt(min, max) {
  return Math.floor(Math.random() * (max - min + 1)) + min;
}

// 实际应用：随机数组元素
function randomChoice(array) {
  return array[Math.floor(Math.random() * array.length)];
}
```

---

## ES5 时代（2009 年）

> **🎯 解决的问题**：ES5 引入了数字格式化方法，解决了数字显示和精度控制的问题，让数字处理更加精确和美观。

### 📝 ES5 数字方法总览

| 功能分类   | 方法            | 语法                         | 参数     | 返回值 | 用途       |
| ---------- | --------------- | ---------------------------- | -------- | ------ | ---------- |
| **格式化** | toFixed()       | `num.toFixed(digits)`        | 小数位数 | 字符串 | 固定小数位 |
| **格式化** | toExponential() | `num.toExponential(digits)`  | 小数位数 | 字符串 | 科学计数法 |
| **格式化** | toPrecision()   | `num.toPrecision(precision)` | 精度     | 字符串 | 指定精度   |

### 🔧 ES5 详细方法说明

**toFixed() - 固定小数位**

```javascript
// 语法：num.toFixed(digits)
// 参数：小数位数
// 返回值：字符串

const num = 123.456789;
console.log(num.toFixed(2)); // "123.46"
console.log(num.toFixed(0)); // "123"

// 实际应用：价格格式化
function formatPrice(price) {
  return `¥${price.toFixed(2)}`;
}
```

**toExponential() - 科学计数法**

```javascript
// 语法：num.toExponential(digits)
// 参数：小数位数
// 返回值：字符串

const num = 123456;
console.log(num.toExponential(2)); // "1.23e+5"

// 实际应用：大数显示
function formatLargeNumber(num) {
  if (num >= 1e6) {
    return num.toExponential(2);
  }
  return num.toString();
}
```

---

## ES2015/ES6 时代（2015 年）

> **🎯 解决的问题**：ES6 引入了更严格的数字检查方法，解决了全局 isNaN() 和 isFinite() 的类型转换问题，让数字验证更加可靠。

### 📝 ES6 数字方法总览

| 功能分类 | 方法                   | 语法                             | 参数        | 返回值 | 用途            |
| -------- | ---------------------- | -------------------------------- | ----------- | ------ | --------------- |
| **检查** | Number.isNaN()         | `Number.isNaN(value)`            | 任意值      | 布尔值 | 严格 NaN 检查   |
| **检查** | Number.isFinite()      | `Number.isFinite(value)`         | 任意值      | 布尔值 | 严格有限数检查  |
| **检查** | Number.isInteger()     | `Number.isInteger(value)`        | 任意值      | 布尔值 | 整数检查        |
| **检查** | Number.isSafeInteger() | `Number.isSafeInteger(value)`    | 任意值      | 布尔值 | 安全整数检查    |
| **转换** | Number.parseInt()      | `Number.parseInt(string, radix)` | 字符串,进制 | 数字   | 全局 parseInt   |
| **转换** | Number.parseFloat()    | `Number.parseFloat(string)`      | 字符串      | 数字   | 全局 parseFloat |

### 🔧 ES6 详细方法说明

**Number.isNaN() - 严格 NaN 检查**

> **🎯 解决的问题**：解决了全局 isNaN() 会进行类型转换的问题，提供更严格的 NaN 检查。

```javascript
// 语法：Number.isNaN(value)
// 参数：任意值
// 返回值：布尔值

console.log(Number.isNaN(NaN)); // true
console.log(Number.isNaN("NaN")); // false
console.log(Number.isNaN(undefined)); // false

// 对比全局isNaN
console.log(isNaN("NaN")); // true (会转换)
console.log(Number.isNaN("NaN")); // false (不转换)

// 实际应用：数字验证
function isValidNumber(value) {
  return typeof value === "number" && !Number.isNaN(value);
}
```

**Number.isInteger() - 整数检查**

```javascript
// 语法：Number.isInteger(value)
// 参数：任意值
// 返回值：布尔值

console.log(Number.isInteger(42)); // true
console.log(Number.isInteger(42.0)); // true
console.log(Number.isInteger(42.1)); // false
console.log(Number.isInteger("42")); // false

// 实际应用：年龄验证
function validateAge(age) {
  return Number.isInteger(age) && age > 0 && age < 150;
}
```

**Number.isSafeInteger() - 安全整数检查**

```javascript
// 语法：Number.isSafeInteger(value)
// 参数：任意值
// 返回值：布尔值

console.log(Number.isSafeInteger(42)); // true
console.log(Number.isSafeInteger(2 ** 53)); // false
console.log(Number.isSafeInteger(2 ** 53 - 1)); // true

// 实际应用：ID验证
function validateId(id) {
  return Number.isSafeInteger(id) && id > 0;
}
```

---

## ES2017 时代（2017 年）

> **🎯 解决的问题**：ES2017 引入了 BigInt，解决了 JavaScript 无法精确表示大整数的问题，让大数计算更加准确。

### 📝 ES2017 数字方法总览

| 功能分类 | 方法                    | 语法                      | 参数        | 返回值 | 用途         |
| -------- | ----------------------- | ------------------------- | ----------- | ------ | ------------ |
| **大数** | BigInt()                | `BigInt(value)`           | 数字/字符串 | BigInt | 创建大整数   |
| **大数** | Number.MAX_SAFE_INTEGER | `Number.MAX_SAFE_INTEGER` | 无          | 数字   | 最大安全整数 |
| **大数** | Number.MIN_SAFE_INTEGER | `Number.MIN_SAFE_INTEGER` | 无          | 数字   | 最小安全整数 |

### 🔧 ES2017 详细方法说明

**BigInt() - 大整数**

> **🎯 解决的问题**：解决了 JavaScript 数字精度限制问题，让大整数计算更加精确。

```javascript
// 语法：BigInt(value)
// 参数：数字或字符串
// 返回值：BigInt

const bigNum = BigInt(1234567890123456789);
const bigStr = BigInt("1234567890123456789");

console.log(bigNum); // 1234567890123456789n
console.log(bigNum + 1n); // 1234567890123456790n

// 实际应用：大数计算
function calculateLargeSum(a, b) {
  return BigInt(a) + BigInt(b);
}
```

---

## ES2021 时代（2021 年）

> **🎯 解决的问题**：ES2021 引入了数字分隔符，解决了大数字可读性问题，让代码中的数字更加清晰易读。

### 📝 ES2021 数字方法总览

| 功能分类   | 方法       | 语法        | 参数 | 返回值 | 用途       |
| ---------- | ---------- | ----------- | ---- | ------ | ---------- |
| **格式化** | 数字分隔符 | `1_000_000` | 无   | 数字   | 数字可读性 |

### 🔧 ES2021 详细方法说明

**数字分隔符 - 提高可读性**

> **🎯 解决的问题**：解决了大数字在代码中难以阅读的问题，让数字更加清晰易读。

```javascript
// 语法：使用下划线分隔数字
// 参数：无
// 返回值：数字

const million = 1_000_000;
const billion = 1_000_000_000;
const hex = 0xff_ec_de_5e;
const binary = 0b1010_0001_1000_0101;

console.log(million); // 1000000
console.log(billion); // 1000000000

// 实际应用：常量定义
const MAX_FILE_SIZE = 10_000_000; // 10MB
const TIMEOUT_MS = 30_000; // 30秒
```

---

## 实际应用场景

### 1. 金融计算场景

**精确的货币计算**

```javascript
// 问题：浮点数精度问题
console.log(0.1 + 0.2); // 0.30000000000000004

// 解决：使用整数计算
function addMoney(a, b) {
  const aCents = Math.round(a * 100);
  const bCents = Math.round(b * 100);
  return (aCents + bCents) / 100;
}

console.log(addMoney(0.1, 0.2)); // 0.3

// 实际应用：购物车计算
function calculateCartTotal(items) {
  return items.reduce((total, item) => {
    return addMoney(total, item.price * item.quantity);
  }, 0);
}
```

### 2. 数据验证场景

**表单数据验证**

```javascript
function validateFormData(data) {
  const errors = [];

  // 年龄验证
  if (!Number.isInteger(data.age) || data.age < 0 || data.age > 150) {
    errors.push("年龄必须是0-150之间的整数");
  }

  // 薪资验证
  if (!Number.isFinite(data.salary) || data.salary < 0) {
    errors.push("薪资必须是正数");
  }

  // 手机号验证
  if (
    !Number.isSafeInteger(data.phone) ||
    data.phone.toString().length !== 11
  ) {
    errors.push("手机号格式不正确");
  }

  return {
    isValid: errors.length === 0,
    errors,
  };
}
```

### 3. 随机数生成场景

**密码生成器**

```javascript
function generatePassword(length = 12) {
  const chars =
    "ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789!@#$%^&*";
  let password = "";

  for (let i = 0; i < length; i++) {
    const randomIndex = Math.floor(Math.random() * chars.length);
    password += chars[randomIndex];
  }

  return password;
}

// 实际应用：用户注册
function createUser(username, email) {
  return {
    username,
    email,
    password: generatePassword(16),
    id: Math.floor(Math.random() * Number.MAX_SAFE_INTEGER),
  };
}
```

---

## 性能对比与最佳实践

### 1. 数字转换性能对比

```javascript
// 性能测试
function performanceTest() {
  const testData = Array.from({ length: 100000 }, () =>
    Math.random().toString()
  );

  // 测试 Number() vs parseInt()
  console.time("Number()");
  testData.forEach((str) => Number(str));
  console.timeEnd("Number()");

  console.time("parseInt()");
  testData.forEach((str) => parseInt(str));
  console.timeEnd("parseInt()");

  // 典型结果：Number() 比 parseInt() 快约 20%
}
```

### 2. 最佳实践建议

**数字处理最佳实践：**

```javascript
// ✅ 推荐：使用 Number.isNaN() 而不是 isNaN()
if (Number.isNaN(value)) {
  // 处理 NaN
}

// ✅ 推荐：使用 Number.isFinite() 而不是 isFinite()
if (Number.isFinite(value)) {
  // 处理有限数
}

// ✅ 推荐：使用 BigInt 处理大整数
const bigNumber = BigInt("1234567890123456789");

// ✅ 推荐：使用数字分隔符提高可读性
const MAX_SIZE = 1_000_000;

// ❌ 避免：直接比较浮点数
// 不好的做法
if (0.1 + 0.2 === 0.3) {
  // 可能不会执行
}

// ✅ 好的做法
if (Math.abs(0.1 + 0.2 - 0.3) < Number.EPSILON) {
  // 正确的浮点数比较
}
```

---

## 面试常考算法

### 1. 数字反转

```javascript
// 方法1：字符串转换
function reverseNumber1(num) {
  const reversed = num.toString().split("").reverse().join("");
  return parseInt(reversed) * Math.sign(num);
}

// 方法2：数学方法
function reverseNumber2(num) {
  let reversed = 0;
  const sign = Math.sign(num);
  num = Math.abs(num);

  while (num > 0) {
    reversed = reversed * 10 + (num % 10);
    num = Math.floor(num / 10);
  }

  return reversed * sign;
}

// 测试
console.log(reverseNumber1(123)); // 321
console.log(reverseNumber2(-456)); // -654
```

### 2. 判断回文数

```javascript
function isPalindrome(num) {
  if (num < 0) return false;
  if (num < 10) return true;

  const str = num.toString();
  return str === str.split("").reverse().join("");
}

// 测试
console.log(isPalindrome(121)); // true
console.log(isPalindrome(123)); // false
```

### 3. 最大公约数

```javascript
// 方法1：辗转相除法
function gcd1(a, b) {
  while (b !== 0) {
    const temp = b;
    b = a % b;
    a = temp;
  }
  return a;
}

// 方法2：递归
function gcd2(a, b) {
  return b === 0 ? a : gcd2(b, a % b);
}

// 测试
console.log(gcd1(48, 18)); // 6
console.log(gcd2(48, 18)); // 6
```

### 4. 质数判断

```javascript
function isPrime(num) {
  if (num < 2) return false;
  if (num === 2) return true;
  if (num % 2 === 0) return false;

  for (let i = 3; i <= Math.sqrt(num); i += 2) {
    if (num % i === 0) return false;
  }

  return true;
}

// 测试
console.log(isPrime(17)); // true
console.log(isPrime(18)); // false
```

---

## 📋 总结

### 记忆技巧

1. **分类记忆**：按功能分类（转换、检查、格式化、计算）
2. **对比记忆**：全局方法 vs Number 方法
3. **精度记忆**：注意浮点数精度问题
4. **安全记忆**：使用安全整数范围
5. **现代记忆**：优先使用 ES6+ 方法

### 使用建议

1. **优先使用 ES6+方法**：更严格、更可靠
2. **注意精度问题**：金融计算使用整数
3. **大数处理**：使用 BigInt
4. **可读性**：使用数字分隔符
5. **性能考虑**：选择合适的方法
